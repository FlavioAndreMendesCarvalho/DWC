<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>JSON</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"/>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
</head>
<body>
<div class="container">
    <h1>Selects Encadenats JSON</h1>
    <form>
        <div class="form-group">
            <label for="select1"></label><select id="select1" class="form-control">
            <option value="0">Selecciona</option>
        </select>
        </div>
        <div class="form-group">
            <label for="select2"></label><select id="select2" class="form-control">
        </select>
        </div>
    </form>
    <br/>
    <h4>Contingut del fitxer JSON 1:</h4>
    <p id="json1"></p>
    <h4>Contingut del fitxer JSON 2:</h4>
    <p id="json2"></p>
</div>

<script>
    $(document).ready(function () {
        var select1 = $("#select1");
        var select2 = $("#select2");
        select2.prop("disabled", true);
        select1.change(function () {
            var valorSeleccionado1 = $(this).val();
            select2.prop("disabled", false);
            select2.empty();
            loadZona(valorSeleccionado1);
        });

        function loadPort() {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                if (this.readyState === 4 && this.status === 200) {
                    $("#json1").html(this.responseText);
                    var port = JSON.parse(this.responseText);
                    for (c in port) {
                        var iterador = c;
                        var idPort = port[iterador].id;
                        var coordenades = carroceries[iterador].idPort;
                        var item = $("<option/>", {value: idPort, text: coordenades});
                        $("#select1").append(item);
                    }
                }
            };
            xhttp.open("GET", "php1.php", true);
            xhttp.send();
        }

        function loadZona(valorSeleccionado1) {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                if (this.readyState === 4 && this.status === 200) {
                    $("#json2").html(this.responseText);
                    var zonas = JSON.parse(this.responseText);
                    var item0 = $("<option/>", {value: "0", text: "Selecciona"});
                    select2.append(item0);
                    for (c in zonas) {
                        var idZona = zonas[c].id;
                        var item = $("<option/>", {value: idZona, text: idZona});
                        select2.append(item);
                    }
                }
            };
            xhttp.open("GET", "php2.php?port=" + valorSeleccionado1, true);
            xhttp.send();
        }

        loadPort();
    });
</script>

</body>
</html>